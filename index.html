<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Launcher - Auto-Update Mods</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            padding: 2rem;
            color: #fff;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .header-title {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 0.5rem;
        }

        .header-title h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #4ade80, #22c55e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-subtitle {
            color: rgba(74, 222, 128, 0.7);
            font-size: 1rem;
        }

        /* Cards */
        .card {
            background: rgba(31, 41, 55, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(74, 222, 128, 0.2);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
        }

        .card-title {
            font-size: 1.25rem;
            color: #4ade80;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            color: #86efac;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .input-group {
            display: flex;
            gap: 0.5rem;
        }

        input[type="text"] {
            flex: 1;
            background: rgba(17, 24, 39, 0.5);
            border: 1px solid rgba(74, 222, 128, 0.3);
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            color: #d1fae5;
            font-size: 0.875rem;
            transition: all 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #4ade80;
            box-shadow: 0 0 0 3px rgba(74, 222, 128, 0.1);
        }

        input[type="text"]::placeholder {
            color: rgba(74, 222, 128, 0.3);
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
        }

        .btn-primary {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #16a34a, #15803d);
        }

        .btn-secondary {
            background: #1e40af;
            color: white;
        }

        .btn-secondary:hover {
            background: #1e3a8a;
        }

        .btn-danger {
            background: #dc2626;
            color: white;
        }

        .btn-danger:hover {
            background: #b91c1c;
        }

        .btn-danger:disabled {
            background: #374151;
            cursor: not-allowed;
            opacity: 0.5;
        }

        .btn-purple {
            background: #9333ea;
            color: white;
        }

        .btn-purple:hover {
            background: #7e22ce;
        }

        .btn-full {
            width: 100%;
        }

        .btn-launch {
            padding: 1.25rem;
            font-size: 1.25rem;
            background: linear-gradient(135deg, #22c55e, #16a34a);
            margin-top: 1rem;
        }

        /* Checkbox */
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        input[type="checkbox"] {
            width: 1.25rem;
            height: 1.25rem;
            cursor: pointer;
            accent-color: #22c55e;
        }

        .checkbox-label {
            color: #86efac;
            cursor: pointer;
            user-select: none;
        }

        /* Mods List */
        .mods-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .mods-count {
            color: rgba(134, 239, 172, 0.7);
            font-size: 0.875rem;
        }

        .mods-list {
            background: rgba(17, 24, 39, 0.5);
            border: 1px solid rgba(74, 222, 128, 0.2);
            border-radius: 0.5rem;
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 1rem;
        }

        .mod-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid rgba(74, 222, 128, 0.1);
            cursor: pointer;
            transition: all 0.2s;
        }

        .mod-item:last-child {
            border-bottom: none;
        }

        .mod-item:hover {
            background: rgba(74, 222, 128, 0.1);
        }

        .mod-item.selected {
            background: rgba(74, 222, 128, 0.2);
        }

        .mod-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex: 1;
        }

        .mod-details {
            flex: 1;
        }

        .mod-name {
            color: #d1fae5;
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .mod-meta {
            color: rgba(74, 222, 128, 0.6);
            font-size: 0.75rem;
        }

        .mod-checkbox {
            width: 1rem;
            height: 1rem;
        }

        .check-icon {
            color: #4ade80;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .mod-item.selected .check-icon {
            opacity: 1;
        }

        /* Action Buttons Grid */
        .action-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.75rem;
        }

        /* Status */
        .status-bar {
            background: rgba(17, 24, 39, 0.5);
            border: 1px solid rgba(74, 222, 128, 0.2);
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            margin-top: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-text {
            color: #4ade80;
            font-size: 0.875rem;
        }

        /* Scrollbar */
        .mods-list::-webkit-scrollbar {
            width: 8px;
        }

        .mods-list::-webkit-scrollbar-track {
            background: rgba(17, 24, 39, 0.5);
            border-radius: 4px;
        }

        .mods-list::-webkit-scrollbar-thumb {
            background: rgba(74, 222, 128, 0.3);
            border-radius: 4px;
        }

        .mods-list::-webkit-scrollbar-thumb:hover {
            background: rgba(74, 222, 128, 0.5);
        }

        /* Icons */
        .icon {
            width: 1.125rem;
            height: 1.125rem;
            display: inline-block;
        }

        .emoji {
            font-size: 1.5rem;
        }

        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }

            .action-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-title">
                <span class="emoji">‚õèÔ∏è</span>
                <h1>Minecraft Launcher</h1>
            </div>
            <p class="header-subtitle">Auto-Update Mods</p>
        </div>

        <!-- Configuration Card -->
        <div class="card">
            <h2 class="card-title">
                <span class="emoji">‚öôÔ∏è</span>
                Configuration
            </h2>

            <div class="form-group">
                <label class="form-label">Dossier Minecraft</label>
                <div class="input-group">
                    <input type="text" id="minecraftPath" placeholder="C:/Users/YourName/AppData/Roaming/.minecraft">
                    <button class="btn btn-primary" onclick="browsePath()">
                        üìÅ Parcourir
                    </button>
                </div>
            </div>


            <div class="checkbox-group">
                <input type="checkbox" id="autoSync" checked>
                <label for="autoSync" class="checkbox-label">Synchronisation automatique des mods</label>
            </div>

            <button class="btn btn-primary btn-full" onclick="saveConfig()">
                üíæ Sauvegarder Config
            </button>
        </div>

        <!-- Mods Management Card -->
        <div class="card">
            <div class="mods-header">
                <h2 class="card-title">
                    <span class="emoji">üì¶</span>
                    Gestion des Mods
                </h2>
                <span class="mods-count" id="modsCount">0 mod(s) dans le repository</span>
            </div>

            <!-- Mods List -->
            <div class="mods-list" id="modsList">
                <!-- Mods will be loaded here dynamically -->
            </div>

            <!-- Action Buttons -->
            <div class="action-grid">
                <button class="btn btn-secondary" onclick="addMod()">
                    ‚ûï Ajouter
                </button>
                <button class="btn btn-danger" id="removeBtn" onclick="removeMod()" disabled>
                    üóëÔ∏è Retirer
                </button>
                <button class="btn btn-purple" onclick="refreshMods()">
                    üîÑ Rafra√Æchir
                </button>
                <button class="btn btn-primary" onclick="checkUpdates()">
                    üì• V√©rifier MAJ
                </button>
            </div>

            <!-- Status Bar -->
            <div class="status-bar">
                <span class="emoji">‚úÖ</span>
                <span class="status-text" id="statusText">Pr√™t</span>
            </div>
        </div>

        <!-- Launch Button -->
        <button class="btn btn-primary btn-full btn-launch" onclick="launchMinecraft()">
            üöÄ LANCER MINECRAFT
        </button>
    </div>

    <script>
        let selectedMods = new Set();
        let mods = [];

        // Load configuration
        function loadConfig() {
            fetch('/api/config')
                .then(res => res.json())
                .then(config => {
                    document.getElementById('minecraftPath').value = config.minecraft_dir || '';
                    document.getElementById('autoSync').checked = config.auto_sync !== false;
                })
                .catch(err => console.error('Error loading config:', err));
        }

        // Save configuration
        function saveConfig() {
            const config = {
                minecraft_dir: document.getElementById('minecraftPath').value,
                auto_sync: document.getElementById('autoSync').checked
            };

            fetch('/api/config', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(config)
            })
            .then(res => res.json())
            .then(data => {
                updateStatus('‚úÖ Configuration sauvegard√©e!', '#4ade80');
            })
            .catch(err => {
                updateStatus('‚ùå Erreur lors de la sauvegarde', '#dc2626');
            });
        }

        // Load mods
        function loadMods() {
            fetch('/api/mods')
                .then(res => res.json())
                .then(data => {
                    mods = data.mods || [];
                    renderMods();
                    updateModsCount();
                })
                .catch(err => console.error('Error loading mods:', err));
        }

        // Render mods list
        function renderMods() {
            const modsList = document.getElementById('modsList');
            modsList.innerHTML = '';

            mods.forEach((mod, index) => {
                const modItem = document.createElement('div');
                modItem.className = 'mod-item' + (selectedMods.has(mod.name) ? ' selected' : '');
                modItem.onclick = () => toggleMod(mod.name);

                modItem.innerHTML = `
                    <div class="mod-info">
                        <input type="checkbox" class="mod-checkbox" ${selectedMods.has(mod.name) ? 'checked' : ''} onclick="event.stopPropagation()">
                        <div class="mod-details">
                            <div class="mod-name">${mod.name}</div>
                            <div class="mod-meta">${mod.size}</div>
                        </div>
                    </div>
                    <span class="check-icon">‚úì</span>
                `;

                modsList.appendChild(modItem);
            });
        }

        // Toggle mod selection
        function toggleMod(modName) {
            if (selectedMods.has(modName)) {
                selectedMods.delete(modName);
            } else {
                selectedMods.add(modName);
            }
            renderMods();
            updateRemoveButton();
        }

        // Update mods count
        function updateModsCount() {
            document.getElementById('modsCount').textContent = `${mods.length} mod(s) dans le repository`;
        }

        // Update remove button state
        function updateRemoveButton() {
            document.getElementById('removeBtn').disabled = selectedMods.size === 0;
        }

        // Update status
        function updateStatus(message, color = '#4ade80') {
            const statusText = document.getElementById('statusText');
            statusText.textContent = message;
            statusText.style.color = color;
        }

        // Browse path
        function browsePath() {
            fetch('/api/browse')
                .then(res => res.json())
                .then(data => {
                    if (data.path) {
                        document.getElementById('minecraftPath').value = data.path;
                    }
                })
                .catch(err => console.error('Error browsing path:', err));
        }

        // Add mod
        function addMod() {
            // Demander le code admin
            const code = prompt('Code admin requis pour ajouter des mods:');
            if (code !== '1596') {
                updateStatus('‚ùå Code admin incorrect!', '#dc2626');
                return;
            }
            
            fetch('/api/add-mod', { method: 'POST' })
                .then(res => res.json())
                .then(data => {
                    updateStatus('‚úÖ Mod(s) ajout√©(s)!', '#4ade80');
                    refreshMods();
                })
                .catch(err => {
                    updateStatus('‚ùå Erreur lors de l\'ajout', '#dc2626');
                });
        }

        // Remove mod
        function removeMod() {
            if (selectedMods.size === 0) return;

            // Demander le code admin
            const code = prompt('Code admin requis pour retirer des mods:');
            if (code !== '1596') {
                updateStatus('‚ùå Code admin incorrect!', '#dc2626');
                return;
            }

            fetch('/api/remove-mod', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ mods: Array.from(selectedMods) })
            })
            .then(res => res.json())
            .then(data => {
                updateStatus('‚úÖ Mod(s) retir√©(s)!', '#4ade80');
                selectedMods.clear();
                refreshMods();
            })
            .catch(err => {
                updateStatus('‚ùå Erreur lors de la suppression', '#dc2626');
            });
        }

        // Refresh mods
        function refreshMods() {
            updateStatus('üîÑ Rafra√Æchissement...', '#fbbf24');
            loadMods();
        }

        // Check updates
        function checkUpdates() {
            updateStatus('üîç V√©rification des mises √† jour...', '#fbbf24');
            fetch('/api/check-updates', { method: 'POST' })
                .then(res => res.json())
                .then(data => {
                    updateStatus(data.message || '‚úÖ V√©rification termin√©e', '#4ade80');
                    loadMods();
                })
                .catch(err => {
                    updateStatus('‚ùå Erreur lors de la v√©rification', '#dc2626');
                });
        }

        // Launch Minecraft
        function launchMinecraft() {
            updateStatus('üöÄ Lancement de Minecraft...', '#fbbf24');
            fetch('/api/launch', { method: 'POST' })
                .then(res => res.json())
                .then(data => {
                    updateStatus('‚úÖ Minecraft lanc√©!', '#4ade80');
                })
                .catch(err => {
                    updateStatus('‚ùå Erreur lors du lancement', '#dc2626');
                });
        }

        // Initialize
        window.onload = function() {
            loadConfig();
            loadMods();
        };
    </script>
</body>
</html>
